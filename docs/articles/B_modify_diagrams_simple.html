<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic modification of diagrams • flowdiagramr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic modification of diagrams">
<meta property="og:description" content="flowdiagramr">
<meta property="og:image" content="https://andreashandel.github.io/flowdiagramr/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flowdiagramr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/A_quickstart.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_quickstart.html">A quick start to flowdiagramr</a>
    </li>
    <li>
      <a href="../articles/B_modify_diagrams_simple.html">Basic modification of diagrams</a>
    </li>
    <li>
      <a href="../articles/C_modify_input_structure.html">Modifying the input structure</a>
    </li>
    <li>
      <a href="../articles/E_non_model_diagrams.html">Making non-model based diagrams</a>
    </li>
    <li>
      <a href="../articles/F_more_model_examples.html">More model examples</a>
    </li>
    <li>
      <a href="../articles/G_additional_topics.html">Additional topics</a>
    </li>
    <li>
      <a href="../articles/H_comparison_to_other_packages.html">Comparison to other R packages</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andreashandel/flowdiagramr">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="B_modify_diagrams_simple_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic modification of diagrams</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/andreashandel/flowdiagramr/blob/master/vignettes/B_modify_diagrams_simple.Rmd"><code>vignettes/B_modify_diagrams_simple.Rmd</code></a></small>
      <div class="hidden name"><code>B_modify_diagrams_simple.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>We assume you went through the <a href="./A_quickstart.html">getting started vignette</a> and know the basics of using <strong>flowdiagramr</strong>. In this vignette, you will learn the simplest ways of customizing diagrams. Further vignettes show more advanced approaches.</p>
</div>
<div id="setting-arguments-in-make_diagram" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-arguments-in-make_diagram" class="anchor"></a>Setting arguments in <code>make_diagram</code>
</h2>
<p>The last example of the <a href="./A_quickstart.html">getting started vignette</a> showed an example on how to customize the diagram by supplying the <code>make_diagram</code> function with an optional list argument <code>diagram_settings</code>. This list argument lets you specify a lot of graphical settings to quickly change the look of your plot. The help file for the function shows you all the settings you can customize, you can look at it with this command</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="st">'make_diagram'</span><span class="op">)</span></code></pre></div>
<p>We are not showing all the options here (you’ll see them when you call the help file), but let’s explore some of those options and what they do.</p>
<p>To illustrate this approach, we’ll play with an extension of the SIR model. For this extension, we also include natural births and deaths. We assume new births only enter the <strong>S</strong> compartment at some fixed flow, <strong>n</strong>, while deaths occur at rate <strong>m</strong> out of all compartments. The model is specified as follows</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># specify the model</span>
<span class="va">varlabels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="st">"I"</span>,<span class="st">"R"</span><span class="op">)</span>
<span class="va">flows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>S_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"-b*S*I"</span>, <span class="st">"-m*S"</span><span class="op">)</span>, 
             I_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"+b*S*I"</span>,<span class="st">"-g*I"</span>, <span class="st">"-m*I"</span><span class="op">)</span>, 
             R_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"g*I"</span>, <span class="st">"-m*R"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sirmodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>varlabels <span class="op">=</span> <span class="va">varlabels</span>, flows <span class="op">=</span> <span class="va">flows</span><span class="op">)</span></code></pre></div>
<p>First, we need to call <code>prepare_diagram</code> to make the list of data frames needed as input for <code>make_model</code>. We’ll skip over this step again for now, you’ll learn more about these data frames and how to potentially modify them, in a later vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># prepare inputs </span>
<span class="va">sir_diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">sirmodel</span><span class="op">)</span></code></pre></div>
<p>Now, let’s produce a basic diagram by calling <code>make_diagram</code> with its defaults.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># make a default diagram</span>
<span class="va">default_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">sir_diagram_list</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">default_diagram</span><span class="op">)</span></code></pre></div>
<p><img src="B_modify_diagrams_simple_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>This looks ok, but maybe you want to make some adjustments. So let’s define some custom settings as a list.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#define settings that change the look of the diagram</span>
<span class="va">sir_diagram_settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    var_outline_color <span class="op">=</span> <span class="st">"black"</span>,
    var_fill_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6aa4c8"</span>, <span class="st">"#eb5600"</span>, <span class="st">"#1a9988"</span><span class="op">)</span>,
    var_label_color <span class="op">=</span> <span class="st">"black"</span>,
    var_label_size <span class="op">=</span> <span class="fl">14</span>,
    main_flow_color <span class="op">=</span> <span class="st">"blue"</span>,
    main_flow_size <span class="op">=</span> <span class="fl">1</span>,
    external_flow_linetype <span class="op">=</span> <span class="st">"dashed"</span>,
    external_flow_label_size <span class="op">=</span> <span class="fl">4</span>,
    interaction_flow_color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>

<span class="co"># make a diagram with adjusted settings</span>
<span class="va">new_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span>
  diagram_list <span class="op">=</span> <span class="va">sir_diagram_list</span>,
  diagram_settings <span class="op">=</span> <span class="va">sir_diagram_settings</span> 
  <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">new_diagram</span><span class="op">)</span></code></pre></div>
<p><img src="B_modify_diagrams_simple_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>As you can see, it is possible to change the look of the diagram considerably by simply providing custom values to the <code>make_diagram</code> input options.</p>
<p>You will note that in the optional <code>diagram_settings</code> list , there is only one type of variable, but 3 types of flows, namely <code>main_flow</code>, <code>interaction_flow</code> and <code>external_flow</code>. <strong>flowdiagramr</strong> groups flows into those 3 categories. <em>Main flows</em> roughly correspond to flows between compartments, <em>interaction flows</em> correspond to processes in which variables interact, and <em>external flows</em> represent inflows from or outflows to non-modeled entities that are outside the system. <strong>flowdiagramr</strong> tries to guess the types of flows based on the model structure, and might not always place the flows into the same conceptual category that you would. That’s ok since as you will learn later, you can change the appearance of each flow individually. Thus, this grouping is mainly for convenience to let you make modifications to conceptually similar flows in an easy manner.</p>
<p>Let’s look at a few more options that you can configure. By default, <strong>flowdiagramr</strong> shows all flows and labels them all. While it is generally a good idea to show as much information as possible in your diagram, sometimes having too much detail leads to a messy and hard-to-read diagram. In such cases, not showing certain parts of the model might make sense.</p>
<p>You can easily turn on and off the different diagram components. The following code shows an example where we turned off showing the external flows completely, and turn off the labeling of the interaction flows.</p>
<p>Note that if you turn off certain components, any settings that apply styling to those settings will be ignored. You can see that in this example, where we kept some settings for the styling, but since flow labels and external flows are not plotted, any styling applied to them is ignored.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#define settings that remove plotting of all flow labels and inflows/outflows</span>
<span class="va">simpler_diagram_settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    var_fill_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6aa4c8"</span>, <span class="st">"#eb5600"</span>, <span class="st">"#1a9988"</span><span class="op">)</span>,
    main_flow_color <span class="op">=</span> <span class="st">"blue"</span>,
    external_flow_on <span class="op">=</span> <span class="cn">FALSE</span>,
    external_flow_linetype <span class="op">=</span> <span class="st">"dashed"</span>,
    external_flow_label_size <span class="op">=</span> <span class="fl">4</span>,
    interaction_flow_label_on <span class="op">=</span> <span class="cn">FALSE</span>,
    interaction_flow_color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>

<span class="co"># make a diagram with adjusted settings</span>
<span class="va">simpler_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span>
  diagram_list <span class="op">=</span> <span class="va">sir_diagram_list</span>,
  diagram_settings <span class="op">=</span> <span class="va">simpler_diagram_settings</span> 
  <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">simpler_diagram</span><span class="op">)</span></code></pre></div>
<p><img src="B_modify_diagrams_simple_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div id="providing-additional-input-when-specifying-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#providing-additional-input-when-specifying-the-model" class="anchor"></a>Providing additional input when specifying the model</h2>
<p>There is another simple, but likely often quite useful way you can make adjustments to the model plot. You previously learned that to specify a model you need to set up a list that contains at minimum the elements <code>varlabels</code> and <code>flows</code>, and this list needs to be sent to <code>prepare_diagram</code>.</p>
<p>Similar to the <code>make_diagram</code> function, the <code>prepare_diagram</code> function also takes a second, optional argument, called <code>model_settings</code>. The help file shows details. Let’s explore this.</p>
<p>You can supply a few additional elements. The element <code>varnames</code> can contain the full names for each variable/compartment (or any other text you might want to display on each box.) If you plan on showing this text, instead of the default <code>varlabels</code> from <code>model_list</code>, you can set the argument <code>use_varnames</code> to <code>TRUE</code>. You need to do this in the diagram preparation stage to allow for proper sizing of the boxes. You can also specify the size of the text with <code>plot_varlabel_size</code>. Finally, a rather useful element is called <code>varlocations</code>, which contains a matrix showing the grid-based arrangement of the compartment boxes. Let’s look at some examples.</p>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example 1</h3>
<p>Here is the SIR model again we just explored. We now specify it with the additional two arguments just introduced.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#model specification - required</span>
<span class="va">sirmodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>varlabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="st">"I"</span>,<span class="st">"R"</span><span class="op">)</span>,
                flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>S_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"-b*S*I"</span>, <span class="st">"-m*S"</span><span class="op">)</span>, 
                             I_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"+b*S*I"</span>,<span class="st">"-g*I"</span>, <span class="st">"-m*I"</span><span class="op">)</span>, 
                             R_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"g*I"</span>, <span class="st">"-m*R"</span><span class="op">)</span><span class="op">)</span>
                <span class="op">)</span>

<span class="co">#optional list of settings</span>
<span class="va">sirsettings</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Susceptible"</span>,<span class="st">"Infected"</span>,<span class="st">"Recovered"</span><span class="op">)</span>,
                   use_varnames <span class="op">=</span> <span class="cn">TRUE</span>,
                   var_label_size <span class="op">=</span> <span class="fl">4</span>,
                   varlocations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">""</span>, <span class="st">"R"</span>,
                                                  <span class="st">""</span>, <span class="st">"I"</span>, <span class="st">""</span> <span class="op">)</span>,nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
                  <span class="op">)</span></code></pre></div>
<p>The arguments <code>varnames</code> <code>use_varnames</code> and <code>plot_varlabel_size</code> should be self-explanatory. See the help file for some more details.</p>
<p>The <code>varlocations</code> argument needs a bit more explanation. What this allows you to do is to define a grid and place the compartments at specific locations. This is often necessary when you create more complicated models since the automated placement of the variables/nodes by <code>make_diagram</code> is likely not ideal. For this simple model, having all compartments along a single row is ok. But to illustrate the use of <code>varlocations</code>, we defined a grid with 2 rows and 3 columns and placed the <strong>S</strong> and <strong>R</strong> compartments in the left and right corner of the top row and the <strong>I</strong> compartment in the middle of the bottom row. All other slots are empty.</p>
<p>With these additional settings, the model diagram looks as follows</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># prepare inputs </span>
<span class="va">sir_diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span>model_list <span class="op">=</span> <span class="va">sirmodel</span>, model_settings <span class="op">=</span> <span class="va">sirsettings</span><span class="op">)</span>
<span class="co"># make  diagram</span>
<span class="va">sir_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span>diagram_list <span class="op">=</span> <span class="va">sir_diagram_list</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sir_diagram</span><span class="op">)</span></code></pre></div>
<p><img src="B_modify_diagrams_simple_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>Note that we also provided the <code>make_diagram</code> function with an option that specified that we wanted to use the variable names to label the boxes instead of the labels/abbreviations.</p>
</div>
<div id="example-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example 2</h3>
<p>Let’s do another example, one that might come up somewhat often, where you need a figure that is mostly vertical. We can do this for the SIR model by adjusting the <code>varlocations</code> matrix and replacing the new structure in the model specification</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">varlocations</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"R"</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>,  byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">sirsettings</span><span class="op">$</span><span class="va">varlocations</span> <span class="op">=</span> <span class="va">varlocations</span>
<span class="va">sirsettings</span><span class="op">$</span><span class="va">use_varnames</span> <span class="op">=</span> <span class="cn">FALSE</span></code></pre></div>
<p>With this setup, the diagram looks like this</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sir_diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">sirmodel</span>, <span class="va">sirsettings</span><span class="op">)</span>
<span class="va">sir_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">sir_diagram_list</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sir_diagram</span><span class="op">)</span></code></pre></div>
<p><img src="B_modify_diagrams_simple_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p><strong>DIAGRAM NOT LOOKING RIGHT</strong></p>
</div>
</div>
<div id="combining-the-two-approaches" class="section level2">
<h2 class="hasAnchor">
<a href="#combining-the-two-approaches" class="anchor"></a>Combining the two approaches</h2>
<p>It is of course possible to adjust the look of the diagram by combining the two approaches we just described.</p>
<p>Let’s look at this for the somewhat large model with 7 compartments shown in the <em>Getting Started</em> vignette.</p>
<p>Here is the model again, this time with locations specified. We place the 2 <em>SIR</em> compartments on the top and the bottom, and the <strong>P</strong> compartment in the middle.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">varlabels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sc"</span>,<span class="st">"Ic"</span>,<span class="st">"Rc"</span>,<span class="st">"Sa"</span>,<span class="st">"Ia"</span>,<span class="st">"Ra"</span>,<span class="st">"P"</span><span class="op">)</span>
<span class="va">varnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Susceptible Children"</span>,<span class="st">"Infected Children"</span>,<span class="st">"Recovered Children"</span>,<span class="st">"Susceptible adults"</span>,<span class="st">"Infected adults"</span>,<span class="st">"Recovered adults"</span>,<span class="st">"Pathogen in Environment"</span><span class="op">)</span>
<span class="va">flows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Sc_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"-Sc*bcc*Ic"</span>,<span class="st">"-Sc*bca*Ia"</span>,<span class="st">"-Sc*bcp*P"</span><span class="op">)</span>, 
             Ic_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sc*bcc*Ic"</span>,<span class="st">"Sc*bca*Ia"</span>,<span class="st">"Sc*bcp*P"</span>,<span class="st">"-gc*Ic"</span><span class="op">)</span>, 
             Rc_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gc*Ic"</span><span class="op">)</span>,
             Sa_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"-Sa*bac*Ic"</span>,<span class="st">"-Sa*baa*Ia"</span>,<span class="st">"-Sa*bap*P"</span><span class="op">)</span>, 
             Ia_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sa*bac*Ic"</span>,<span class="st">"Sa*baa*Ia"</span>,<span class="st">"Sa*bap*P"</span>,<span class="st">"-ga*Ia"</span><span class="op">)</span>, 
             Ra_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ga*Ia"</span><span class="op">)</span>,
             P_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sc*Ic"</span>,<span class="st">"sa*Ia"</span>,<span class="st">"-d*P"</span><span class="op">)</span>
             <span class="op">)</span>
<span class="va">varlocations</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sc"</span>, <span class="st">"Ic"</span>, <span class="st">"Rc"</span>,
                               <span class="st">""</span>,   <span class="st">"P"</span>,   <span class="st">""</span>,
                               <span class="st">"Sa"</span>, <span class="st">"Ia"</span>, <span class="st">"Ra"</span><span class="op">)</span>,nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">mymodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>varlabels <span class="op">=</span> <span class="va">varlabels</span>, flows <span class="op">=</span> <span class="va">flows</span><span class="op">)</span>
<span class="va">mysettings</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>varlocations <span class="op">=</span> <span class="va">varlocations</span>, varnames <span class="op">=</span> <span class="va">varnames</span>, use_varnames <span class="op">=</span> <span class="cn">TRUE</span>, var_label_size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">mymodel</span>, <span class="va">mysettings</span><span class="op">)</span></code></pre></div>
<p>In a next step, we apply different styling to the diagram</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagram_settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
       var_fill_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6aa4c8"</span>, <span class="st">"#eb5600"</span>, <span class="st">"#1a9988"</span>, <span class="st">"#2987c2"</span>, <span class="st">"#e38b59"</span>, <span class="st">"#5c948c"</span>, <span class="st">"#e8e656"</span><span class="op">)</span>,
       interaction_flow_label_size <span class="op">=</span> <span class="fl">4</span>,
       interaction_flow_color <span class="op">=</span> <span class="st">"blue"</span>
                        <span class="op">)</span>
<span class="va">model_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">diagram_list</span>, <span class="va">diagram_settings</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model_plot</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_text).</span>

<span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_text).</span></code></pre></div>
<p><img src="B_modify_diagrams_simple_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p><strong>SOME ARROWS SEEM TO START/END IN MIDDLE OF BOXES INSTEAD OF EDGES. BOX SIZING NOT RIGHT.</strong></p>
<p>This starts to look better, though the placement of the labels is clearly not ideal and needs some more tweaking.</p>
</div>
<div id="next-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next steps</h2>
<p>With the approach just discussed, you can tweak the look of the diagram a good bit. This might give you a diagram that’s good enough for what you want. However, at times you might want to make further changes. For instance you might want to tweak the placement of the boxes and arrows or add some extra text somewhere on the diagram. <strong>flowdiagramr</strong> gives you ways of doing this.</p>
<p>After you have exhausted the modifications described here, and need to make further changes, we recommend as a next step to tweak the input structure that is produced by the <code>prepare_diagram</code> function before sending it to the <code>make_diagram</code> function. This gives you a good bit more flexibility in adjusting the model, and is not that difficulty to do. This is described <a href="./C_modify_input_structure.html">in the next vignette</a>.</p>
<p>Finally, it is possible to obtain the underlying code that produces the plot and manually adjust anything you like. This is most flexible, but also requires the most manual intervention. We get to that after you have gone through the <a href="./C_modify_input_structure.html">next vignette</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.andreashandel.com">Andreas Handel</a>, Andrew Tredennick.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
