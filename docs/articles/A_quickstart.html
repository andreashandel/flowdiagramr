<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A quick start to flowdiagramr • flowdiagramr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A quick start to flowdiagramr">
<meta property="og:description" content="flowdiagramr">
<meta property="og:image" content="https://andreashandel.github.io/flowdiagramr/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flowdiagramr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/A_quickstart.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_quickstart.html">Quick Start Guide</a>
    </li>
    <li>
      <a href="../articles/B_prepare_diagram_settings.html">Modifying diagrams I</a>
    </li>
    <li>
      <a href="../articles/C_update_diagram_function.html">Modifying diagrams II</a>
    </li>
    <li>
      <a href="../articles/D_modify_ggplot_code.html">Modifying the ggplot2 object or code</a>
    </li>
    <li>
      <a href="../articles/E_non_model_diagrams.html">Making non-model based diagrams</a>
    </li>
    <li>
      <a href="../articles/F_additional_examples.html">Additional diagram examples</a>
    </li>
    <li>
      <a href="../articles/G_additional_topics.html">Additional topics</a>
    </li>
    <li>
      <a href="../articles/H_comparison_to_other_packages.html">Comparison to other R packages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andreashandel/flowdiagramr" class="external-link">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A quick start to flowdiagramr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/andreashandel/flowdiagramr/blob/HEAD/vignettes/A_quickstart.Rmd" class="external-link"><code>vignettes/A_quickstart.Rmd</code></a></small>
      <div class="hidden name"><code>A_quickstart.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>flowdiagramr</strong> is designed to create nice-looking
diagrams for compartmental simulation models and other kinds of
scenarios where a model with compartments/variables/nodes and
flows/connections/edges is needed. The user provides the compartments
and the flows, and gets as return a model diagram in ggplot format, as
well as code that created the diagram. This allows potentially complete
customization of the diagram.</p>
</div>
<div class="section level2">
<h2 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h2>
<p>The kinds of models and diagrams we are discussing here are used in
many different areas of science. That also means there are many
different ways and words to describe these models. What we mainly refer
to as <em>compartments</em> or <em>variables</em> is also known as
<em>stocks</em> or <em>nodes</em>. Similarly, what we mainly refer to as
<em>flows</em> or <em>processes</em> is also known as
<em>connections</em> or <em>edges</em>. Other terminology exists. While
we try to use <strong>variables</strong> and <strong>flows</strong> as
consistently as possible, we might occasionally accidentally use one of
the other terms. We hope by showing examples it will be clear.</p>
</div>
<div class="section level2">
<h2 id="starting-example">Starting Example<a class="anchor" aria-label="anchor" href="#starting-example"></a>
</h2>
<p>Here is a simple example to illustrate what
<strong>flowdiagramr</strong> does.</p>
<p>Consider the <a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology" class="external-link">Susceptible-Infected-Recovered
(SIR) model</a> which forms the basis of many models used in infectious
disease epidemiology. For this model, we have 3 compartments/variables,
name susceptible individuals, <strong>S</strong>, infected/infectious
individuals, <strong>I</strong>, and recovered/removed individuals,
<strong>R</strong>. We also have 2 processes/flows, one process by which
susceptible individuals become infected at some rate after contact with
infectious individuals, <strong>b*S*I</strong> and a process by which
infected individuals recover at some rate, <strong>g*I.</strong></p>
<p>Written out as differential equations, the model looks like this</p>
<p><span class="math display">\[
\begin{aligned}
\dot S &amp; = - b S I \\
\dot I &amp; = b S I - g I \\
\dot R &amp; = g I
\end{aligned}
\]</span></p>
<p>A diagram for the model looks as follows</p>
<div class="figure" style="text-align: center">
<img src="sirdiagram.png" alt="Flow diagram for basic SIR model" width="90%"><p class="caption">
Flow diagram for basic SIR model
</p>
</div>
<p>The purpose of <strong>flowdiagramr</strong> is to automatically
create this diagram for you if you supply the model specification. Here
is how.</p>
<div class="section level3">
<h3 id="specify-the-model">Specify the model<a class="anchor" aria-label="anchor" href="#specify-the-model"></a>
</h3>
<p><strong>flowdiagramr</strong> requires that the model is specified as
a simple list structure. This list needs to have 2 elements, the
variable/compartment labels and the processes/flows for each
compartment. For the model above, this looks as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="st">"I"</span>,<span class="st">"R"</span><span class="op">)</span></span>
<span><span class="va">flows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-b*S*I"</span><span class="op">)</span>, </span>
<span>             I_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b*S*I"</span>,<span class="st">"-g*I"</span><span class="op">)</span>, </span>
<span>             R_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g*I"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mymodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>variables <span class="op">=</span> <span class="va">variables</span>, flows <span class="op">=</span> <span class="va">flows</span><span class="op">)</span></span></code></pre></div>
<p><strong>Model specification conventions and
requirements:</strong></p>
<ul>
<li>The main list (called <code>mymodel</code> above) can have any
name.</li>
<li>Inside this list need to be two elements called
<code>variables</code> and <code>flows</code>, which contain - surprise!
- the variable and flow information.</li>
<li>Variables need to be supplied as a vector of strings, and need to
start with an upper-case letter and can be any combination of letters
and numbers.</li>
<li>Model flows consist of variables and parameters, combined by basic
mathematical expressions. Currently allowed are
<code>+, -, *, (),/,^</code>. Mathematical operations such as
<code>log</code>, <code>sin</code>, etc. are currently not supported
(but you can still possibly use <code>flowdiagramr</code> - read
on).</li>
<li>All parameters need to start with a lower-case letter and can be any
combination of letters and numbers.</li>
<li>The flows for each variable need to be named <code>NN_flows</code>
where <code>NN</code> corresponds to the variable name.</li>
<li>Each flow needs to be provided as a valid mathematical/R expression,
that would evaluate in R if you assigned numbers to each parameter and
variable. For instance you need to write <code>b*S*I</code>, writing it
as <code>bSI</code> will not work.</li>
<li>Flows need to be provided as a list, with flows for each variable as
a vector.</li>
<li>Minus signs for outflows are required, plus signs for inflows are
optional.</li>
</ul>
<p><em>If these specifications sound confusing, just look at several of
the examples and you’ll quickly understand the whole setup.</em></p>
</div>
<div class="section level3">
<h3 id="create-elements-needed-for-diagram-generation">Create elements needed for diagram generation<a class="anchor" aria-label="anchor" href="#create-elements-needed-for-diagram-generation"></a>
</h3>
<p>Once you specified your model in the list structure just described,
the next step is to process the model, then make the diagram. This
happens in two steps, which has the advantage of easier diagram
modification.</p>
<p>In a first step, you send your model to the
<code><a href="../reference/prepare_diagram.html">prepare_diagram()</a></code> function to prepare it for later
plotting.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">mymodel</span><span class="op">)</span></span></code></pre></div>
<p>The <code>diagram_list</code> object returned by this function
contains a list of data frames that is used to make the diagram. We’ll
skip over this for now and revisit it in a later vignette.</p>
</div>
<div class="section level3">
<h3 id="make-the-diagram">Make the diagram<a class="anchor" aria-label="anchor" href="#make-the-diagram"></a>
</h3>
<p>Now it’s time to make the diagram. This is done by sending the object
you got by calling <code><a href="../reference/prepare_diagram.html">prepare_diagram()</a></code> to the
<code><a href="../reference/make_diagram.html">make_diagram()</a></code> function, like so</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">diagram_list</span><span class="op">)</span></span></code></pre></div>
<p><code>make_diagram</code> returns a ggplot2 object (here called
<code>my_diagram</code>).</p>
<p>You you can plot the object with</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_diagram</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_quickstart_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>or save it into a file, e.g. with</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"sirdiagram.png"</span>,<span class="va">my_diagram</span><span class="op">)</span></span></code></pre></div>
<p>To re-cap, these lines of code allowed us to specify and make a
fairly simple flow diagram:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#specify model</span></span>
<span><span class="va">mymodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="st">"I"</span>,<span class="st">"R"</span><span class="op">)</span>,</span>
<span>                flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-b*S*I"</span><span class="op">)</span>, </span>
<span>                             I_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b*S*I"</span>,<span class="st">"-g*I"</span><span class="op">)</span>, </span>
<span>                             R_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g*I"</span><span class="op">)</span><span class="op">)</span></span>
<span>              <span class="op">)</span></span>
<span><span class="co">#prepare diagram</span></span>
<span><span class="va">diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">mymodel</span><span class="op">)</span></span>
<span><span class="co">#make diagram</span></span>
<span><span class="va">my_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">diagram_list</span><span class="op">)</span></span>
<span><span class="co">#plot diagram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_diagram</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="another-example">Another example<a class="anchor" aria-label="anchor" href="#another-example"></a>
</h2>
<p>Here is another example, the classical <a href="https://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equations" class="external-link">predator-prey
model (also known as Lotka-Volterra model)</a>. This model has two
compartments/variables. The model is widely used in Ecology. It can also
be used in Immunology to model pathogen and immune response. In the
context of immunology, the immune response (e.g. Macrophages or NK
cells) are the predators, and the pathogens (e.g. some bacteria) are the
prey. We’ll label them <strong>Imm</strong> and <strong>Pat</strong>,
just to show that one can use labels that are longer than a single
letter. We will also include the following processes/flows:</p>
<ol style="list-style-type: decimal">
<li>
<code>g*Pat*(1-Pat/pmax)</code>: Bacteria/Pathogen grow/divide at
some maximum rate (which we label <em>g</em>) and saturate as they
approach some maximum carrying capacity, <em>p<sub>max</sub></em>.</li>
<li>
<code>-dP*Pat</code>: Bacteria/Pathogen die at a natural death rate
(which we label <em>d<sub>P</sub></em>).</li>
<li>
<code>-k*Pat*Imm</code>: Bacteria/Pathogen are killed by the immune
response at some rate <em>k</em>.</li>
<li>
<code>r*Pat*Imm</code>: The immune response grows proportional to
the amount of bacteria/pathogen and itself at some rate <em>r</em>.</li>
<li>
<code>-dI*Imm</code>: The immune response decays at some rate (which
we label <em>d<sub>I</sub></em>).</li>
</ol>
<p>To generate the diagram, you follow the same steps as above. First,
create the model structure</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pat"</span>,<span class="st">"Imm"</span><span class="op">)</span></span>
<span><span class="va">flows</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Pat_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g*Pat*(1-Pat/pmax)"</span>, <span class="st">"-dP*Pat"</span>, <span class="st">"-k*Pat*Imm"</span><span class="op">)</span>,</span>
<span>                 Imm_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r*Pat*Imm"</span>, <span class="st">"-dI*Imm"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mymodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">variables</span>, <span class="va">flows</span><span class="op">)</span></span></code></pre></div>
<p>Again, remember that all flows need to be valid mathematical
expressions, i.e. if you typed them into <code>R</code>, they would work
(provided you assigned numerical values to each variable and
parameter).</p>
<p>Next, you use the same steps as above to create the model diagram.
First, we prepare the diagram.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">mymodel</span><span class="op">)</span></span></code></pre></div>
<p>Now we can make and plot it.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">diagram_list</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_diagram</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_quickstart_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>It is possible to change the look of the diagram fairly easily using
the <code><a href="../reference/update_diagram.html">update_diagram()</a></code> function. You’ll learn more about this
in a later vignette. Here is a quick preview. You provide the
<code><a href="../reference/update_diagram.html">update_diagram()</a></code> function with the
<code>diagram_list</code> object produced by <code><a href="../reference/make_diagram.html">make_diagram()</a></code>
and tell it what adjustments you want to make by specifying
<code>diagram_settings</code>. You get an updated object, which you can
then turn into a diagram.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagram_list_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_diagram.html">update_diagram</a></span><span class="op">(</span><span class="va">diagram_list</span>, </span>
<span>                                  diagram_settings <span class="op">=</span> </span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>var_fill_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Pat <span class="op">=</span> <span class="st">'blue'</span>, Imm <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span>, </span>
<span>                                       flow_line_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"dashed"</span>, external <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span>,</span>
<span>                                       flow_line_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>all <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span>                                      <span class="op">)</span></span>
<span>                                  <span class="op">)</span></span></code></pre></div>
<p>Here is the figure for the updated diagram.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">diagram_list_v2</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_diagram</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_quickstart_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>For completeness, here are the ODE equations for the model we just
plotted.</p>
<p><span class="math display">\[
\begin{aligned}
\frac{d}{dt}  Pat &amp; = g * Pat (1-\frac{Pat}{p_{max}}) - d_P * Pat -
k * Pat * Imm \\
\frac{d}{dt} Imm &amp; = r * Pat * Imm - d_I * Imm
\end{aligned}
\]</span></p>
<p>As a reminder, for the purpose of generating the diagram, it is not
required to write down mathematical equations for the model. In fact,
you can make diagrams for any model that consists of compartments and
flows. The underlying model could be a set of ordinary differential
equations (ODEs), or a discrete time model, or a stochastic one. It can
even be a completely different system comprising compartments and flows,
one that is not based on simulation models. This is discussed in the
<em>Making non-model based diagrams</em> vignette.</p>
</div>
<div class="section level2">
<h2 id="one-more-example">One more example<a class="anchor" aria-label="anchor" href="#one-more-example"></a>
</h2>
<p>We’ll finish with one more model, this time a more complex one.</p>
<p>This is an SIR-type model that also includes an environmental
component, i.e. infected individuals can shed the pathogen into the
environment (e.g., Cholera in water) and susceptible individuals can get
infected that way. We still allow for direct transmission. On top of
that, we are considering 2 distinct groups (e.g., children and adults)
and stratify by them. They are assumed to shed into the same environment
(which we label <strong>P</strong>) at rates <code>ra</code> and
<code>rc</code>. Transmission occurs at rates <span class="math inline">\(b_ij\)</span>, where <span class="math inline">\(i\)</span> is the infected category (including the
infected environment) and <span class="math inline">\(j\)</span> the
susceptible category.</p>
<p>This gives us 3 SIR compartments each for adults and children, i.e.,
6, and 1 environmental compartment, for a total of 7 compartments.</p>
<p>Here is the model specified in the format needed for
<strong>flowdiagramr</strong>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sc"</span>,<span class="st">"Ic"</span>,<span class="st">"Rc"</span>,<span class="st">"Sa"</span>,<span class="st">"Ia"</span>,<span class="st">"Ra"</span>,<span class="st">"P"</span><span class="op">)</span></span>
<span><span class="va">flows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Sc_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-bcc*Sc*Ic"</span>,<span class="st">"-bca*Sc*Ia"</span>,<span class="st">"-bcp*Sc*P"</span><span class="op">)</span>, </span>
<span>             Ic_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bcc*Sc*Ic"</span>,<span class="st">"bca*Sc*Ia"</span>,<span class="st">"bcp*Sc*P"</span>,<span class="st">"-gc*Ic"</span><span class="op">)</span>, </span>
<span>             Rc_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gc*Ic"</span><span class="op">)</span>,</span>
<span>             Sa_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-bac*Sa*Ic"</span>,<span class="st">"-baa*Sa*Ia"</span>,<span class="st">"-bap*Sa*P"</span><span class="op">)</span>, </span>
<span>             Ia_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bac*Sa*Ic"</span>,<span class="st">"baa*Sa*Ia"</span>,<span class="st">"bap*Sa*P"</span>,<span class="st">"-ga*Ia"</span><span class="op">)</span>, </span>
<span>             Ra_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ga*Ia"</span><span class="op">)</span>,</span>
<span>             P_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rc*Ic"</span>,<span class="st">"ra*Ia"</span>,<span class="st">"-d*P"</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span><span class="va">mymodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>variables <span class="op">=</span> <span class="va">variables</span>, flows <span class="op">=</span> <span class="va">flows</span><span class="op">)</span></span></code></pre></div>
<p>Before we start making the diagram for this model, it is worth
pointing out some current limitations of <strong>flowdiagramr</strong>.
You might have noticed that each flow term above is defined separately.
If you were to write down the model in math formulation, you would
likely not do that. Instead, you would probably write something like
this, with flow terms combined using parentheses:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sc"</span>,<span class="st">"Ic"</span>,<span class="st">"Rc"</span>,<span class="st">"Sa"</span>,<span class="st">"Ia"</span>,<span class="st">"Ra"</span>,<span class="st">"P"</span><span class="op">)</span></span>
<span><span class="va">flows_wrong</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Sc_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-Sc*(bcc*Ic+bca*Ia+bcp*P)"</span><span class="op">)</span>,</span>
<span>             Ic_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sc*(bcc*Ic+bca*Ia+bcp*P)"</span>,<span class="st">"-gc*Ic"</span><span class="op">)</span>,</span>
<span>             Rc_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gc*Ic"</span><span class="op">)</span>,</span>
<span>             Sa_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-Sa*(bac*Ic+baa*Ia+bap*P)"</span><span class="op">)</span>,</span>
<span>             Ia_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sa*(bac*Ic+baa*Ia+bap*P)"</span>,<span class="st">"-ga*Ia"</span><span class="op">)</span>,</span>
<span>             Ra_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ga*Ia"</span><span class="op">)</span>,</span>
<span>             P_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rc*Ic"</span>,<span class="st">"ra*Ia"</span>,<span class="st">"-d*P"</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span><span class="va">model_list_wrong</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>variables <span class="op">=</span> <span class="va">variables</span>, flows <span class="op">=</span> <span class="va">flows_wrong</span><span class="op">)</span></span></code></pre></div>
<p>Unfortunately, <strong>flowdiagramr</strong> currently cannot parse
flows that are grouped like this (we hope that a future version will).
If you try to use this model list to prepare the diagram, you will
receive a (hopefully informative) error message.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">model_list_wrong</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in prepare_diagram(model_list_wrong): flowdiagramr cannot currently process flows that include an interaction between more than two variables.</span></span>
<span><span class="co">#&gt;  Consider breaking flows apart.</span></span></code></pre></div>
<p>In general, <code>prepare_diagram</code> checks your
<code>model_list</code> object and tries to determine if everything is
ok. As an example, here is the model with some typos. We accidentally
put minus (“-”) signs in front of all the <code>Ia_flows</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sc"</span>,<span class="st">"Ic"</span>,<span class="st">"Rc"</span>,<span class="st">"Sa"</span>,<span class="st">"Ia"</span>,<span class="st">"Ra"</span>,<span class="st">"P"</span><span class="op">)</span></span>
<span><span class="va">flows_wrong2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Sc_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-bcc*Sc*Ic"</span>,<span class="st">"-bca*Sc*Ia"</span>,<span class="st">"-bcp*Sc*P"</span><span class="op">)</span>, </span>
<span>             Ic_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bcc*Sc*Ic"</span>,<span class="st">"bca*Sc*Ia"</span>,<span class="st">"bcp*Sc*P"</span>,<span class="st">"-gc*Ic"</span><span class="op">)</span>, </span>
<span>             Rc_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gc*Ic"</span><span class="op">)</span>,</span>
<span>             Sa_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-bac*Sa*Ic"</span>,<span class="st">"-baa*Sa*Ia"</span>,<span class="st">"-bap*Sa*P"</span><span class="op">)</span>, </span>
<span>             Ia_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-bac*Sa*Ic"</span>,<span class="st">"-baa*Sa*Ia"</span>,<span class="st">"-bap*Sa*P"</span>,<span class="st">"-ga*Ia"</span><span class="op">)</span>, </span>
<span>             Ra_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ga*Ia"</span><span class="op">)</span>,</span>
<span>             P_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rc*Ic"</span>,<span class="st">"ra*Ia"</span>,<span class="st">"-d*P"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">model_list_wrong2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>variables <span class="op">=</span> <span class="va">variables</span>, flows <span class="op">=</span> <span class="va">flows_wrong2</span><span class="op">)</span></span></code></pre></div>
<p>This means the model is not properly specified.
<strong>flowdiagramr</strong> throws an error suggesting where you might
have gone wrong.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">model_list_wrong2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in prepare_diagram(model_list_wrong2): There are duplicate flows across variables that failed to</span></span>
<span><span class="co">#&gt; parse easily. Are there '+' signs where you intended</span></span>
<span><span class="co">#&gt; '-' signs, or vice versa.</span></span></code></pre></div>
<p>Not all model bugs return informative error messages. There are
likely instances where you have typos or other mistakes in your model,
or you try to include components in our model that
<strong>flowdiagramr</strong> currently can’t handle, and you end up
with a confusing error message from flowdiagramr. In this case, the
first place to check for bugs is in your model specification, especially
your model flows. Of course, you could have also found a bug in
flowdiagramr, in which case please file an <a href="https://github.com/andreashandel/flowdiagramr/issues" class="external-link">issue on the
Github site of the package</a>!</p>
<p>The reverse is also true. It might be that
<strong>flowdiagramr</strong> doesn’t flag problems with your model,
even if there are any. In that case, you might either get an error
message later in the process, or you’ll get a weird looking diagram.</p>
<p>Now, let’s go back to the first, proper model specification. We’ll
first prepare the diagram. Here, we supply
<code><a href="../reference/prepare_diagram.html">prepare_diagram()</a></code> with optional settings. This is just
meant as another quick preview. The next vignette will discuss this in
detail.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_settings</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>varbox_x_size <span class="op">=</span> <span class="fl">2</span>, varbox_y_size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">diagram_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">mymodel</span>, <span class="va">model_settings</span><span class="op">)</span></span></code></pre></div>
<p>Now we make the diagram and plot it.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">diagram_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_quickstart_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<p>As you can see, while the most basic approach of using
<strong>flowdiagramr</strong> that we just explained gets you
<em>somewhere</em>, you might not be able to produce a
publication-quality diagram using just the default settings.
Fortunately, <strong>flowdiagramr</strong> gives you ways to easily
customize things to give you great-looking diagrams! (At least we think
so, but we might be a bit biased.)</p>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>You just learned the basics of using <strong>flowdiagramr</strong> to
produce a diagram. The default diagram you get this way might look ok
(for simple models), but it likely won’t be great. Therefore, most of
the time you will likely want to make modifications to get a diagram
that looks the way you want. There are different ways to do this. To
start learning these different ways, you should continue with <a href="./B_prepare_diagram_settings.html">this vignette</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.andreashandel.com" class="external-link">Andreas Handel</a>, Andrew Tredennick.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
