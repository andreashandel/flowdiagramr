<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A quick start to flowdiagramr • flowdiagramr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A quick start to flowdiagramr">
<meta property="og:description" content="flowdiagramr">
<meta property="og:image" content="https://andreashandel.github.io/modeldiagram/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flowdiagramr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/quickstart.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_quickstart.html">A quick start to flowdiagramr</a>
    </li>
    <li>
      <a href="../articles/B_modify-diagrams-simple.html">Basic modification of a diagram</a>
    </li>
    <li>
      <a href="../articles/C_technical-details.html">Technical details</a>
    </li>
    <li>
      <a href="../articles/D_modify-diagrams-advanced.html">Advanced modification of a diagram</a>
    </li>
    <li>
      <a href="../articles/E_non_model_diagrams.html">Other Diagrams</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andreashandel/modeldiagram">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="A_quickstart_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A quick start to flowdiagramr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/andreashandel/flowdiagramr/blob/master/vignettes/A_quickstart.Rmd"><code>vignettes/A_quickstart.Rmd</code></a></small>
      <div class="hidden name"><code>A_quickstart.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p><strong>flowdiagramr</strong> is designed to create nice-looking diagrams for compartmental simulation models and other kinds of scenarios where a model with compartments/nodes and flows/connections is needed. The user provides the compartments and the flows, and gets as return a model diagram in ggplot format, as well as code that created the diagram and can be further modified.</p>
</div>
<div id="terminology" class="section level1">
<h1 class="hasAnchor">
<a href="#terminology" class="anchor"></a>Terminology</h1>
<p>The kinds of models and diagrams we are discussing here are used in many different areas of science. That also means there are many different ways and terminology to describe these models. What we mainly refer to as <em>compartments</em> or <em>variables</em> is also known as <em>stocks</em> or <em>nodes</em>. Similarly, what we mainly refer to as <em>flows</em> or <em>processes</em> is also known as <em>connections</em> or … We hope by showing examples it will be clear.</p>
</div>
<div id="starting-example" class="section level1">
<h1 class="hasAnchor">
<a href="#starting-example" class="anchor"></a>Starting Example</h1>
<p>Here is a simple example to illustrate the process. Let’s assume we have a simple Susceptible-Infected-Recovered model, which is the starting point for a lot of infectious disease models. In this case, we have 3 compartments, name susceptible individuals, <strong>S</strong>, infected/infectious individuals, <strong>I</strong>, and recovered/removed individuals, <strong>R</strong>. We also have 2 processes/flows, one process by which susceptible individuals become infected at some rate after contact with infectious individuals, <strong>b*S*I</strong> and a process by which infected individuals recover at some rate, <strong>g*I.</strong></p>
<p>Written out as differential equations, the model looks like this</p>
<p><span class="math display">\[
\begin{aligned}
\dot S &amp; = - b S I \\ 
\dot I &amp; = b S I - g I \\
\dot R &amp; = g I 
\end{aligned}
\]</span></p>
<p>A diagram for the model looks as follows</p>
<p><img src="sirdiagram.png" width="70%"></p>
<p>Here is how you can use <strong>flowdiagramr</strong> to create this diagram.</p>
<div id="specify-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#specify-the-model" class="anchor"></a>Specify the model</h2>
<p><strong>flowdiagramr</strong> wants the model input as a simple list structure. This list has 3 elements, the variable/compartment labels, optional their full-text names, and the processes/flows for each compartment. For the model above, this structure would look as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">varlabels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="st">"I"</span>,<span class="st">"R"</span><span class="op">)</span>
<span class="va">varnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Susceptible"</span>,<span class="st">"Infected"</span>,<span class="st">"Recovered"</span><span class="op">)</span>
<span class="va">flows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>S_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"-b*S*I"</span><span class="op">)</span>, 
                I_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b*S*I"</span>,<span class="st">"-g*I"</span><span class="op">)</span>, 
                R_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"g*I"</span><span class="op">)</span><span class="op">)</span>
<span class="va">mymodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>varlabels <span class="op">=</span> <span class="va">varlabels</span>, varnames <span class="op">=</span> <span class="va">varnames</span>, flows <span class="op">=</span> <span class="va">flows</span><span class="op">)</span></code></pre></div>
<p>Note that the main list (called <code>mymodel</code> above) can have any name, but the elements inside the list need to be called <code>varlabels</code>, <code>varnames</code> and <code>flows</code>. The <code>varnames</code> entry is optional. Also, the flows for each variable need to be named <code>X_flows</code> where X corresponds to the variable label (this doesn’t have to be a single letter). Finally, the flows need to be provided as valid mathematical expressions, so you need to write <code>b*S*I</code>, writing it as <code>bSI</code> will not work.</p>
</div>
<div id="create-elements-needed-for-diagram-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#create-elements-needed-for-diagram-generation" class="anchor"></a>Create elements needed for diagram generation</h2>
<p>Once you have placed your model into a simple structure like the one above, you can start preparing the diagram generation. This happens in two steps (which as the advantage of easier manual modification, see below). First, you create a set of data frames that are used as input into the actual diagram plotting code. You do this as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input_structure</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">mymodel</span><span class="op">)</span></code></pre></div>
<p>The <code>input_structure</code> object contains a list of data frames used by the actual diagram generation code. We’ll skip over this for now, you can learn more about it and how to manipulate it <a href="">here</a>.</p>
</div>
<div id="make-the-diagram" class="section level2">
<h2 class="hasAnchor">
<a href="#make-the-diagram" class="anchor"></a>Make the diagram</h2>
<p>Now it’s time to make the diagram. This is done by sending the input structure you just created to the <code>make_diagram</code> function, like so</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">input_structure</span><span class="op">)</span></code></pre></div>
<p><code>make_diagram</code> returns an object (here called <code>my_diagram</code>) which is a ggplot2 plot. You you can write this plot to a file or print to the screen, e.g. with</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"sirdiagram.png"</span>,<span class="va">my_diagram</span><span class="op">)</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">my_diagram</span><span class="op">)</span></code></pre></div>
<p><img src="A_quickstart_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div id="another-example" class="section level1">
<h1 class="hasAnchor">
<a href="#another-example" class="anchor"></a>Another example</h1>
<p>Here is one more example, a classical predator-prey model from Ecology (also used in e.g. immunology to model pathogen and immune response). This model has two compartments/variables. In the context of immunology, the immune response, <strong>I</strong>, is the predator, and the pathogen (e.g. bacteria), <strong>B</strong>, are the prey. We will also include the following processes/flows:</p>
<ol style="list-style-type: decimal">
<li>Bacteria grow/divide at some maximum rate (which we label <em>g</em>) and saturate as they approach some maximum carrying capacity, <em>B<sub>max</sub></em>.</li>
<li>Bacteria die at a natural death rate (which we label <em>d<sub>B</sub></em>).</li>
<li>Bacteria are killed by the immune response at some rate <em>k</em>.</li>
<li>The immune response grows proportional to the number of bacteria and itself at some rate <em>r</em>.</li>
<li>The immune response decays at some rate (which we label <em>d<sub>I</sub></em>).</li>
</ol>
<p>Written out as differential equations, the model looks like this</p>
<p><span class="math display">\[
\begin{aligned}
\dot B &amp; = g B (1-\frac{B}{B_{max}}) - d_B B - k BI \\
\dot I &amp; = r B I - d_I I
\end{aligned}
\]</span> The model diagram is as follows.</p>
<p><img src="predpreydiagram.png" width="70%"></p>
<p>To generate the diagram, you follow the same steps as above. First, create the model structure</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">varlabels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B"</span>,<span class="st">"I"</span><span class="op">)</span>
<span class="va">varnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bacteria"</span>,<span class="st">"Immunity"</span><span class="op">)</span>
<span class="va">flows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>B_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"+g*B*(1-B/bmax)"</span>, <span class="st">"-dB*B"</span>, <span class="st">"-k*B*I"</span><span class="op">)</span>,
             I_flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"+r*B*I"</span>, <span class="st">"-dI*I"</span><span class="op">)</span><span class="op">)</span>
<span class="va">mymodel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>varlabels <span class="op">=</span> <span class="va">varlabels</span>, varnames <span class="op">=</span> <span class="va">varnames</span>, flows <span class="op">=</span> <span class="va">flows</span><span class="op">)</span></code></pre></div>
<p>Again, remember that all flows need to be valid mathematical expressions, i.e. if you typed them into <code>R</code>, they would work (provided you assigned numerical values to each variable and parameter).</p>
<p>Next, prepare the model, then create it and plot it.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input_structure</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_diagram.html">prepare_diagram</a></span><span class="op">(</span><span class="va">mymodel</span><span class="op">)</span>
<span class="va">my_diagram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_diagram.html">make_diagram</a></span><span class="op">(</span><span class="va">input_structure</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">my_diagram</span><span class="op">)</span></code></pre></div>
<p><img src="A_quickstart_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>In this example, we added some optional inputs to the <code>make_diagram</code> function to start customizing the model, you’ll learn more about this next.</p>
</div>
<div id="next-steps" class="section level1">
<h1 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next steps</h1>
<p>You just learned the basics of using <strong>flowdiagramr</strong> to produce a diagram. The default diagram you get this way should look ok (most of the time), but it won’t be great. Sometimes, the default will actually not look that great, especially if you have a complicated model. Therefore, most of the time you will likely want to make further modifications to get a diagram that looks exactly the way you want. There are different ways to do this, which are described in <a href="">this vignette</a>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="st">""</span>,<span class="st">"R"</span>,
          <span class="st">""</span>,<span class="st">"I"</span>,<span class="st">""</span><span class="op">)</span>
<span class="va">varlabels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">data</span>,nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.andreashandel.com">Andreas Handel</a>, Andrew Tredennick.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
